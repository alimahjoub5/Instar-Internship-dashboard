<div class="subscription-plans-container">
  <!-- Header -->
  <div class="header-section">
    <div class="header-content">
      <h1>
        <mat-icon>subscriptions</mat-icon>
        Subscription Plans
      </h1>
      <p>Manage subscription plans and their features</p>
    </div>
    <div class="header-actions">
      <button mat-raised-button color="primary" routerLink="add">
        <mat-icon>add</mat-icon>
        Add New Plan
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <mat-spinner></mat-spinner>
    <p>Loading subscription plans...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !isLoading" class="error-container">
    <mat-icon>error</mat-icon>
    <h3>Error</h3>
    <p>{{ error }}</p>
    <button mat-raised-button color="primary" (click)="loadSubscriptionPlans()">
      <mat-icon>refresh</mat-icon>
      Try Again
    </button>
  </div>

  <!-- Plans Grid -->
  <div *ngIf="!isLoading && !error" class="plans-grid">
    <mat-card *ngFor="let plan of plans" class="plan-card">
      <mat-card-header>
        <mat-card-title>
          <div class="plan-header">
            <div class="plan-info">
              <h2>{{ plan.name }}</h2>
              <mat-chip [color]="getPlanColor(plan.type)" selected>
                {{ plan.type | titlecase }}
              </mat-chip>
            </div>
            <div class="plan-price">
              <span class="price">{{ formatPrice(plan.price) }}</span>
              <span class="duration">/ {{ formatDuration(plan.duration) }}</span>
            </div>
          </div>
        </mat-card-title>
        <mat-card-subtitle>
          {{ plan.description }}
        </mat-card-subtitle>
      </mat-card-header>

      <mat-card-content>
        <!-- Plan Limits -->
        <div class="plan-limits">
          <div class="limit-item">
            <mat-icon>inventory</mat-icon>
            <span>{{ plan.features.maxProducts }} Products</span>
          </div>
          <div class="limit-item">
            <mat-icon>image</mat-icon>
            <span>{{ plan.features.maxImages }} Images</span>
          </div>
        </div>

        <!-- Features -->
        <div class="features-section">
          <h4>Features</h4>
          <div class="features-grid">
            <div *ngFor="let feature of getActiveFeatures(plan)" class="feature-item">
              <mat-icon>{{ getFeatureIcon(feature) }}</mat-icon>
              <span>{{ getFeatureLabel(feature) }}</span>
            </div>
          </div>
        </div>

        <!-- Status -->
        <div class="plan-status">
          <mat-chip [color]="plan.isActive ? 'primary' : 'warn'" selected>
            {{ plan.isActive ? 'Active' : 'Inactive' }}
          </mat-chip>
        </div>
      </mat-card-content>

      <mat-card-actions>
                 <button mat-button color="primary" [routerLink]="['edit', plan._id!]" *ngIf="plan._id">
           <mat-icon>edit</mat-icon>
           Edit
         </button>
                 <button mat-button color="warn" (click)="deletePlan(plan._id!)" *ngIf="plan._id">
           <mat-icon>delete</mat-icon>
           Delete
         </button>
                 <button mat-button color="accent" [routerLink]="['view', plan._id!]" *ngIf="plan._id">
           <mat-icon>visibility</mat-icon>
           View Details
         </button>
      </mat-card-actions>
    </mat-card>
  </div>

  <!-- Empty State -->
  <div *ngIf="!isLoading && !error && plans.length === 0" class="empty-state">
    <mat-icon>subscriptions</mat-icon>
    <h3>No Subscription Plans</h3>
    <p>No subscription plans found. Create your first plan to get started.</p>
    <button mat-raised-button color="primary" routerLink="add">
      <mat-icon>add</mat-icon>
      Create First Plan
    </button>
  </div>
</div> 